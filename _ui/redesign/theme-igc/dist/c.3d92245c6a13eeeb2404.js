(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{MjON:function(e,t,o){"use strict";o("vxnP");var i=o("+njy"),s=o.n(i),n=o("qmvR"),r=o("hsyc");s.a.disable();var l=Backbone.View.extend({baseTemplate:_.template('\n        <div class="rollover j-rollover {{=rolloverClass}}">\n            <div class="rollover_head">\n                {{ if (showBack) { }}\n                <div class="rollover_head__back j-rollover-back"></div>\n                {{ } }}\n                {{ if (titleLink) { }}\n                <a class="rollover_head__title_link" href="{{=url}}">\n                {{ } }}\n                <h4 class="rollover_head__title">{{=title}}</h4>\n                {{ if (titleLink) { }}\n                </a>\n                {{ } }}\n                <div class="rollover_head__close j-rollover-close"></div>\n            </div>\n            <div class="rollover_body"></div>\n        </div>\n    '),events:{"click .j-rollover-close":"backThroughTime","click .j-rollover-back":"goToPreviousRollover","click .j-rollover-link":"goNext","click a":"navigate",mouseenter:"clearAutoClose"},defaults:{destroyOnClose:!0,titleLink:!1,show:!0,showBack:!1},preinitialize:function(e){this.events=_.extend(this.events,l.prototype.events)},initialize:function(e){return this.setElement($('<div class="rollovers j-rollovers"></div>').appendTo(r.a)),this.onOutsideClick=this.onOutsideClick.bind(this),this.onHistoryPop=this.onHistoryPop.bind(this),this.close=this.close.bind(this),setTimeout(function(){$(".j-rollovers.open").on("click.rolloverOutside keydown.rolloverOutside",this.onOutsideClick)}.bind(this),0),this.settings=_.extend({},this.defaults,e),this.settings.content&&(this.settings.title="Catalog",this.settings.contentParent=this.settings.content.parent(),this.settings.content.appendTo(this.$el)),this.rolloverContainer=[],!this.$el.html()&&this.template&&(this.template=_.template(this.template),this.render()),this.settings.show&&this.open(),"number"==typeof this.settings.autoCloseTimeout&&this.settings.autoCloseTimeout>0&&this.setupAutoClose(this.settings.autoCloseTimeout),this},setTitle:function(e){return this.$(".rollover_head__title").text(e),this},setHead:function(e){this.$(".rollover_head").html(e)},setBody:function(e){return this.$(".rollover_body").html(e),this},openRollover:function(e){e.addClass("open")},closeRollover:function(e){e.removeClass("open").css("height","")},open:function(){var e=this;this.trigger("open"),this.$el.addClass("open"),r.a.addClass("no-scroll");var t=this.$el.children(".j-rollover");return requestAnimationFrame((function(){e.$el.addClass("transition"),e.openRollover(t),n.c&&s.a.enable()})),this.setHistory(),this},close:function(){return this.trigger("close"),this.$el.removeClass("transition"),r.a.removeClass("no-scroll"),this.closeRollover(this.$el.children(".j-rollover")),setTimeout(function(){for(var e=this.rolloverContainer.pop();void 0!==e;)this.$el.children(".j-rollover").last().removeClass("open").appendTo(e),e=this.rolloverContainer.pop();this.$el.removeClass("open"),s.a.disable(),this.settings.destroyOnClose&&this.destroy()}.bind(this),300),$(".j-rollovers.open").off(".rolloverOutside"),window.removeEventListener("popstate",this.onHistoryPop),this},openNextRollover:function(e,t){var o=this;this.closeRollover(e),this.rolloverContainer.push(t.parent()),t.appendTo(e.parent()),requestAnimationFrame((function(){return o.openRollover(t)}))},openPreviousRollover:function(e,t){e||t||(t=(e=this.$el.children(".open")).prev());var o=this.rolloverContainer.pop();this.closeRollover(e),setTimeout((function(){return e.appendTo(o)}),300),this.openRollover(t)},goNext:function(e){var t=$(e.currentTarget),o=t.closest(".j-rollover"),i=t.siblings(".j-rollover");e.preventDefault(),e.stopImmediatePropagation(),i.length?(window.history.pushState({component:"rollover",name:this.settings.title,index:this.rolloverContainer.length+2},""),this.openNextRollover(o,i)):this.navigate(e)},backThroughTime:function(){$("#fragrance-finder").length?this.close():window.history.go(-(this.rolloverContainer.length+1))},navigate:function(e){var t=$(e.currentTarget);e.preventDefault(),e.stopPropagation(),this.pendingNavigation=t.attr("href"),this.backThroughTime()},goToPreviousRollover:function(){window.history.go(-1)},setHistory:function(){var e=this,t={component:"rollover",name:this.settings.title,index:1};setTimeout((function(){if(window.history.state&&"rollover"===window.history.state.component){window.addEventListener("popstate",(function o(){window.history.state&&window.history.state.name!==e.settings.title?history.go(-1):(window.removeEventListener("popstate",o),window.history.pushState(t,""),window.addEventListener("popstate",e.onHistoryPop))})),history.go(-1)}else window.history.pushState(t,""),window.addEventListener("popstate",e.onHistoryPop)}))},destroy:function(){return this.trigger("destroy"),this.off("all"),this.settings.contentParent&&this.settings.content.appendTo(this.settings.contentParent),this.remove(),this},setupAutoClose:function(){var e=this;this.settings.closeTimeout=setTimeout((function(){e.close(),clearTimeout(e.settings.closeTimeout)}),this.settings.autoCloseTimeout)},clearAutoClose:function(){clearTimeout(this.settings.closeTimeout),this.settings.closeTimeout=0},isOpen:function(){return this.$(".j-rollovers.open").length>0},onOutsideClick:function(e){if("click"===e.type){if(e.originalEvent&&0===(e.originalEvent.path||e.originalEvent.composedPath&&e.originalEvent.composedPath()||[]).indexOf(this.el))return e.preventDefault(),this.backThroughTime()}else if("keydown"===e.type&&27===e.keyCode)return e.preventDefault(),this.backThroughTime();return!0},onHistoryPop:function(e){var t=e.state;if("rollover"===(null==t?void 0:t.component))t.name===this.settings.title?t.index===this.rolloverContainer.length&&this.openPreviousRollover():this.close();else if(this.pendingNavigation){var o=this.pendingNavigation;this.pendingNavigation=null,window.location.href=o}else this.close()},render:function(){var e=this.model.toJSON();return this.$el.append(this.baseTemplate(this.settings)),this.$(".rollover_body").html(this.template(e)),this}});t.a=l},Ypbz:function(e,t,o){"use strict";o.r(t);var i=o("MjON"),s=o("nH/H"),n=i.a.extend({template:'\n        <ul class="rollover_body__links">\n            <li class="j-use_location">\n                <a>\n                    <span class="icon icon_crosshair"></span>\n                    {{=messages.useCurrent}}\n                </a>\n            </li>\n            <li>\n                <a href="{{=links.allStores}}">\n                    <span class="icon icon_map-pin"></span>\n                    {{=messages.seeAll}}\n                </a>\n            </li>\n        </ul>\n    ',initialize:function(){i.a.prototype.initialize.call(this,{title:this.model.get("title"),rolloverClass:"header__rollover header__rollover_store_finder",titleLink:!0,url:TPS.actions.STORE_FINDER}),this.renderSearch(this.$(".rollover_body"))}});_.extend(n.prototype,s.a),t.default=n},"nH/H":function(e,t,o){"use strict";var i=o("Xapy"),s=Backbone.Model.extend({defaults:{title:TPS.messages["redesign.store.finder.menu.title"],messages:{useCurrent:TPS.messages["redesign.store.finder.menu.use.current.location"],seeAll:TPS.messages["redesign.store.finder.menu.see.all.stores"]},links:{allStores:i.a.ALL_STORES}}});t.a={footerTemplate:'\n        <form class="store_finder-search_form j-search_form" method="get"\n              action="'.concat(i.c.STORE_FINDER,'"\n              role="search"\n          >\n            <span class="icon icon_search"></span>\n            <input type="search" id="postal-code" name="postal-code" placeholder="Insert postcode..." aria-label="').concat(TPS.messages["redesign.accessibility.ariaLabel.enterPostcode"],'"/>\n            <input type="hidden" name="useLocation" value="false" />\n        </form>\n    '),events:{"keydown .j-search_form":"useUserPostcode","click .j-search_form":"preventDefault","click .j-use_location":"useLocation"},model:new s,renderSearch:function(e){e?e.append(this.footerTemplate):this.setFooter(this.footerTemplate)},useLocation:function(e){var t=this;e.preventDefault(),"geolocation"in navigator?(this.useLocationClicked=!0,navigator.geolocation.getCurrentPosition((function(e){t.$(".j-search_form").find("[name=useLocation]").val("true").end().submit()}),(function(e){t.model.set({error:e})}))):this.model.set("error","Geolocation is not available")},useUserPostcode:function(e){var t=e.key||e.keyCode;"Enter"!==t&&13!==t||this.$(".j-search_form").submit()},preventDefault:function(e){e.preventDefault()}}}}]);