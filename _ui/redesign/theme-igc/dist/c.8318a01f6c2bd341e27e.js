(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{"+2J/":function(e,t,i){"use strict";i.d(t,"b",(function(){return s}));var n=i("8Qz1"),s=function(){var e=n.h.get("entries").filter((function(e){return!(e.get("product").reward||e.get("isFreeSample"))}));return TPS.user.isLoyalty&&n.h.get("entries").length>0&&0===e.length&&!n.h.get("rewardAvailable")},o=Backbone.View.extend({initialize:function(){this.model.on("change",this.render,this)},render:function(){this.$el.toggle(s())}});t.a=o},"9TJh":function(e,t,i){},EBYT:function(e,t,i){"use strict";t.a='\n<div class="mini_cart {{=addProduct ? \'mini_cart-added\' : \'\'}}">\n    {{ if (entries.length) { }}\n        <ul class="mini_cart_products j-products_list"></ul>\n        <div class="mini_cart_total_price">\n            <div class="mini_cart_total_price__container">\n                <span class="mini_cart_total_price__text">{{=TPS.messages[\'redesign.mini.basket.total.price.text\']}}</span>\n                <span class="mini_cart_total_price__subtotal j-cart-price">{{=formattedPrice}}</span>\n            </div>\n        </div>\n        <div class="mini_cart_buttons">\n            {{ if (subTotal && subTotal.value > 0 && !needProductForReward) { }}\n                <a href="{{=links.cart}}" class="mini_cart_buttons__item mini_cart_buttons__item-checkout j-shopping_bag_link">\n                    <span class="mini_cart_buttons__text">{{=TPS.messages[\'redesign.mini.basket.checkout.button.name\']}}</span>\n                    <span class="mini_cart_buttons__icon icon icon_lock-light"></span>\n                </a>\n            {{ } else { }}\n                <button class="mini_cart_buttons__item mini_cart_buttons__item-shopping btn-black j-continue-shopping">\n                    {{=TPS.messages[\'redesign.mini.basket.continue.shopping.button.text\']}}\n                </button>\n            {{ } }}\n        </div>\n        {{ if (error) { }}\n            <div class="mini_cart__error">{{=error}}</div>\n        {{ } }}\n        {{ if (vouchersApplied) { }}\n            <div class="mini_cart__info">{{=TPS.messages[\'redesign.mini.basket.checkout.discountAdded\']}}</div>\n        {{ } }}\n    {{ } else { }}\n        {{ if (vouchersApplied) { }}\n            <div class="mini_cart__info">{{=TPS.messages[\'redesign.mini.basket.checkout.discountAdded\']}}</div>\n        {{ } }}\n        {{ if (error) { }}\n            <div class="mini_cart__error">{{=error}}</div>\n        {{ } else { }}\n            <div class="mini_cart_empty">\n                <p class="mini_cart_empty__text">\n                    {{=TPS.messages[\'redesign.mini.basket.empty.text\']}}\n                </p>\n            </div>\n            <div class="mini_cart_buttons">\n                <button class="mini_cart_buttons__item mini_cart_buttons__item-shopping btn-black j-continue-shopping">\n                    {{=TPS.messages[\'redesign.mini.basket.continue.shopping.button.text\']}}\n                </button>\n            </div>\n        {{ } }}\n    {{ } }}\n</div>\n'},Junv:function(e,t,i){"use strict";var n=i("I+eb"),s=i("6LWA"),o=[].reverse,r=[1,2];n({target:"Array",proto:!0,forced:String(r)===String(r.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),o.call(this)}})},MjON:function(e,t,i){"use strict";i("vxnP");var n=i("+njy"),s=i.n(n),o=i("qmvR"),r=i("hsyc");s.a.disable();var a=Backbone.View.extend({baseTemplate:_.template('\n        <div class="rollover j-rollover {{=rolloverClass}}">\n            <div class="rollover_head">\n                {{ if (showBack) { }}\n                <div class="rollover_head__back j-rollover-back"></div>\n                {{ } }}\n                {{ if (titleLink) { }}\n                <a class="rollover_head__title_link" href="{{=url}}">\n                {{ } }}\n                <h4 class="rollover_head__title">{{=title}}</h4>\n                {{ if (titleLink) { }}\n                </a>\n                {{ } }}\n                <div class="rollover_head__close j-rollover-close"></div>\n            </div>\n            <div class="rollover_body"></div>\n        </div>\n    '),events:{"click .j-rollover-close":"backThroughTime","click .j-rollover-back":"goToPreviousRollover","click .j-rollover-link":"goNext","click a":"navigate",mouseenter:"clearAutoClose"},defaults:{destroyOnClose:!0,titleLink:!1,show:!0,showBack:!1},preinitialize:function(e){this.events=_.extend(this.events,a.prototype.events)},initialize:function(e){return this.setElement($('<div class="rollovers j-rollovers"></div>').appendTo(r.a)),this.onOutsideClick=this.onOutsideClick.bind(this),this.onHistoryPop=this.onHistoryPop.bind(this),this.close=this.close.bind(this),setTimeout(function(){$(".j-rollovers.open").on("click.rolloverOutside keydown.rolloverOutside",this.onOutsideClick)}.bind(this),0),this.settings=_.extend({},this.defaults,e),this.settings.content&&(this.settings.title="Catalog",this.settings.contentParent=this.settings.content.parent(),this.settings.content.appendTo(this.$el)),this.rolloverContainer=[],!this.$el.html()&&this.template&&(this.template=_.template(this.template),this.render()),this.settings.show&&this.open(),"number"==typeof this.settings.autoCloseTimeout&&this.settings.autoCloseTimeout>0&&this.setupAutoClose(this.settings.autoCloseTimeout),this},setTitle:function(e){return this.$(".rollover_head__title").text(e),this},setHead:function(e){this.$(".rollover_head").html(e)},setBody:function(e){return this.$(".rollover_body").html(e),this},openRollover:function(e){e.addClass("open")},closeRollover:function(e){e.removeClass("open").css("height","")},open:function(){var e=this;this.trigger("open"),this.$el.addClass("open"),r.a.addClass("no-scroll");var t=this.$el.children(".j-rollover");return requestAnimationFrame((function(){e.$el.addClass("transition"),e.openRollover(t),o.c&&s.a.enable()})),this.setHistory(),this},close:function(){return this.trigger("close"),this.$el.removeClass("transition"),r.a.removeClass("no-scroll"),this.closeRollover(this.$el.children(".j-rollover")),setTimeout(function(){for(var e=this.rolloverContainer.pop();void 0!==e;)this.$el.children(".j-rollover").last().removeClass("open").appendTo(e),e=this.rolloverContainer.pop();this.$el.removeClass("open"),s.a.disable(),this.settings.destroyOnClose&&this.destroy()}.bind(this),300),$(".j-rollovers.open").off(".rolloverOutside"),window.removeEventListener("popstate",this.onHistoryPop),this},openNextRollover:function(e,t){var i=this;this.closeRollover(e),this.rolloverContainer.push(t.parent()),t.appendTo(e.parent()),requestAnimationFrame((function(){return i.openRollover(t)}))},openPreviousRollover:function(e,t){e||t||(t=(e=this.$el.children(".open")).prev());var i=this.rolloverContainer.pop();this.closeRollover(e),setTimeout((function(){return e.appendTo(i)}),300),this.openRollover(t)},goNext:function(e){var t=$(e.currentTarget),i=t.closest(".j-rollover"),n=t.siblings(".j-rollover");e.preventDefault(),e.stopImmediatePropagation(),n.length?(window.history.pushState({component:"rollover",name:this.settings.title,index:this.rolloverContainer.length+2},""),this.openNextRollover(i,n)):this.navigate(e)},backThroughTime:function(){$("#fragrance-finder").length?this.close():window.history.go(-(this.rolloverContainer.length+1))},navigate:function(e){var t=$(e.currentTarget);e.preventDefault(),e.stopPropagation(),this.pendingNavigation=t.attr("href"),this.backThroughTime()},goToPreviousRollover:function(){window.history.go(-1)},setHistory:function(){var e=this,t={component:"rollover",name:this.settings.title,index:1};setTimeout((function(){if(window.history.state&&"rollover"===window.history.state.component){window.addEventListener("popstate",(function i(){window.history.state&&window.history.state.name!==e.settings.title?history.go(-1):(window.removeEventListener("popstate",i),window.history.pushState(t,""),window.addEventListener("popstate",e.onHistoryPop))})),history.go(-1)}else window.history.pushState(t,""),window.addEventListener("popstate",e.onHistoryPop)}))},destroy:function(){return this.trigger("destroy"),this.off("all"),this.settings.contentParent&&this.settings.content.appendTo(this.settings.contentParent),this.remove(),this},setupAutoClose:function(){var e=this;this.settings.closeTimeout=setTimeout((function(){e.close(),clearTimeout(e.settings.closeTimeout)}),this.settings.autoCloseTimeout)},clearAutoClose:function(){clearTimeout(this.settings.closeTimeout),this.settings.closeTimeout=0},isOpen:function(){return this.$(".j-rollovers.open").length>0},onOutsideClick:function(e){if("click"===e.type){if(e.originalEvent&&0===(e.originalEvent.path||e.originalEvent.composedPath&&e.originalEvent.composedPath()||[]).indexOf(this.el))return e.preventDefault(),this.backThroughTime()}else if("keydown"===e.type&&27===e.keyCode)return e.preventDefault(),this.backThroughTime();return!0},onHistoryPop:function(e){var t=e.state;if("rollover"===(null==t?void 0:t.component))t.name===this.settings.title?t.index===this.rolloverContainer.length&&this.openPreviousRollover():this.close();else if(this.pendingNavigation){var i=this.pendingNavigation;this.pendingNavigation=null,window.location.href=i}else this.close()},render:function(){var e=this.model.toJSON();return this.$el.append(this.baseTemplate(this.settings)),this.$(".rollover_body").html(this.template(e)),this}});t.a=a},QiGF:function(e,t,i){"use strict";i("FZtP"),i("Junv"),i("vxnP");var n=i("8Qz1"),s=Backbone.View.extend({tagName:"li",template:_.template('\n        <div class="mini_cart_products_item">\n            <a class="mini_cart_products_item__link" {{ if (!product.reward) { }} href="{{=product.url}} {{ } }}">\n                <img class="mini_cart_products_item__img" src="{{=image.src}}" title="{{=image.text}}" alt="">\n            </a>\n            <div class="mini_cart_products_item_description">\n                <div class="mini_cart_products_item_description__container">\n                    <a class="mini_cart_products_item_description__brand_name" {{ if (!isFreeSample && !product.reward) { }} href="{{=product.url}}" {{ } }}>{{=product.brand}}</a>\n                    <a class="mini_cart_products_item_description__wrapper_link" {{ if (!isFreeSample && !product.reward) { }} href="{{=product.url}}" {{ } }}">\n                        <p class="mini_cart_products_item_description__range_name">{{= !isFreeSample && gwpEntry ? product.escapeName : product.range}}</p>\n\n                    {{ if (!isFreeSample) { }}\n                        {{ if (!gwpEntry) { }}\n                            <p class="mini_cart_products_item_description__type_name">\n                                {{=product.escapeName}}{{ if(product.baseOptions[0].selected.igcContentSizeUnit) { }} - {{=product.baseOptions[0].selected.igcContentSizeUnit}}{{ } }}\n                            </p>\n                        {{ } else { }}\n                            <p class="mini_cart_products_item_description__type_name">\n                                {{=product.range}}\n                            </p>\n                        {{ } }}\n                    {{ } }}\n                    </a>\n                </div>\n                <div class="mini_cart_products_item_info">\n                    <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                        <span class="mini_cart_products_item_info__amount">{{=quantity}}</span>\n                    </span>\n                    <span class="mini_cart_products_item_info__price">{{=price.base}}</span>\n                </div>\n            </div>\n            <div class="mini_cart_products_item__remove_icon j-remove_product">\n                {{ if (!gwpEntry || isFreeSample) { }}\n                    <span class="icon_cross-light"></span>\n                {{ } }}\n            </div>\n            <div class="mini_cart_products_item-removed j-after_product_remove">\n                <div class="mini_cart_products_item__wrapper">\n                    <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                </div>\n            </div>\n        </div>\n        {{ if (giftWrapProductCode) { }}\n            <div class="mini_cart_products_item j-gift">\n                <a class="mini_cart_products_item__link" href="javascript:void(0);">\n                    <img class="mini_cart_products_item__img" src="{{=giftEntry.image.src}}" title="{{=giftEntry.image.text}}" alt="">\n                </a>\n                <div class="mini_cart_products_item_description">\n                    <div class="mini_cart_products_item_description__container">\n                        <a class="mini_cart_products_item_description__range_name" href=\'javascript:void(0);\'>\n                            {{=giftEntry.product.escapeName}}\n                        </a>\n                    </div>\n                    <div class="mini_cart_products_item_info">\n                        <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                            <span class="mini_cart_products_item_info__amount">{{=quantity}}</span>\n                        </span>\n                        <span class="mini_cart_products_item_info__price">{{=giftWrapPrice.formattedValue}}</span>\n                    </div>\n                </div>\n                <div class="mini_cart_products_item__remove_icon j-remove_gift">\n                    <span class="icon_cross-light"></span>\n                </div>\n                <div class="mini_cart_products_item-removed j-after_gift_remove">\n                    <div class="mini_cart_products_item__wrapper">\n                        <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                    </div>\n                </div>\n            </div>\n        {{ } }}\n        {{ if (engravings.length) { }}\n            <div class="mini_cart_products_item j-engravings">\n                <a class="mini_cart_products_item__link" href="javascript:void(0);">\n                    <span class="mini_cart_products_item__icon icon_engraving"></span>\n                </a>\n                <div class="mini_cart_products_item_description">\n                    <div class="mini_cart_products_item_description__container">\n                        <a class="mini_cart_products_item_description__range_name" href=\'javascript:void(0);\'>\n                            {{=TPS.messages[\'redesign.mini.basket.item.engraved.message\']}}\n                        </a>\n                    </div>\n                    <div class="mini_cart_products_item_info">\n                        <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                            <span class="mini_cart_products_item_info__amount">{{=engravings.length}}</span>\n                        </span>\n                        <span class="mini_cart_products_item_info__price">{{=formattedEngravingPrice}}</span>\n                    </div>\n                </div>\n                <div class="mini_cart_products_item__remove_icon j-remove_engraving">\n                    <span class="icon_cross-light"></span>\n                </div>\n                <div class="mini_cart_products_item-removed j-after_engraving_remove">\n                    <div class="mini_cart_products_item__wrapper">\n                        <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                    </div>\n                </div>\n            </div>\n        {{ } }}\n    '),initialize:function(){this.model.on("change",this.render,this)},events:{"click .j-remove_product":"removeProduct","click .j-remove_gift":"removeGift","click .j-remove_engraving":"removeEngraving"},removeProduct:function(e){var t=this;if(e.stopPropagation(),!this.model.get("gwpEntry")||this.model.get("isFreeSample")){this.$el.addClass("spinner"),this.trigger("delete-item");var i=this.model.toJSON(),s={sku:i.product.code,quantity:i.quantity};Object(n.w)(this.model.get("entryNumber"),s).then((function(){t.$el.removeClass("spinner"),t.$(".j-after_product_remove").fadeIn(300),t.$el.fadeTo(800,0,(function(){return t.$el.slideUp(500,(function(){return t.$el.remove()}))}))}))}},removeGift:function(){var e=this,t=this.$(".j-gift");t.addClass("spinner"),Object(n.x)(this.model.get("entryNumber")).then((function(){t.removeClass("spinner"),e.$(".j-after_gift_remove").fadeIn(300),t.fadeTo(800,0,(function(){return t.slideUp(500)}))}))},removeEngraving:function(e){var t=this,i=this.$(".j-engravings");i.addClass("spinner"),Object(n.u)(this.model.get("product").code).then((function(){i.removeClass("spinner"),t.$(".j-after_engraving_remove").fadeIn(300),i.fadeTo(800,0,(function(){return i.slideUp(500)}))}))},render:function(e){if(e){if(e.changed.engravings)return;if(""===e.changed.giftWrapProductCode)return}var t=this.model.toJSON();return this.$el.html(this.template(t)),this}}),o=Backbone.View.extend({initialize:function(){this.render()},deleteItem:function(){this.trigger("delete-item")},render:function(){var e=this,t=$();return this.model.filter((function(e){return!(e.get("engraving")||e.get("giftWrap"))})).reverse().forEach((function(i){var n=new s({model:i});n.on("delete-item",e.deleteItem,e),t=t.add(n.render().$el)})),this.$el.empty(),this.$el.append(t),this}});t.a=o},emwd:function(e,t,i){"use strict";i.r(t);i("vxnP");var n=i("EBYT"),s=i("MjON"),o=i("iCQ7"),r=i("QiGF"),a=i("8Qz1"),c=i("Xapy"),l=i("+2J/"),d=(i("9TJh"),s.a.extend({template:n.a,model:new o.a({entries:a.g,formattedPrice:a.h.get("subTotal").formattedValue}),events:{"click .j-continue-shopping":"onContinueShoppingClick","click .j-shopping_bag_link, .j-secure_checkout_link":"onLinkClick"},initialize:function(e){this.model.set({addProduct:e.added,vouchersApplied:e.vouchersApplied,error:e.error,deletedItems:!1}),s.a.prototype.initialize.call(this,_.extend(e,{rolloverClass:"header__rollover header__rollover_bag",title:TPS.messages[e.added?"redesign.mini.basket.items.added":"redesign.mini.basket.title.text"],showBack:!1})),this.$(".mini_cart").addClass("Basket_Lvl2"),e.added&&!e.vouchersApplied&&(this.$(".rollover_head").prepend('<span class="mini_cart_header_added__icon icon_check"></span>'),this.$(".rollover_head__title").removeClass("rollover_head__title").addClass("mini_cart_header_added__text")),a.h.on("change",this.onBasketDataChanged,this),this.model.on("change:formattedPrice",this.onPriceChange,this),this.onBasketDataChanged()},onContinueShoppingClick:function(e){e.preventDefault(),this.model.get("deletedItems")||window.location.pathname===c.b.HOME?this.close():(this.close(),window.location.href=c.b.HOME)},onLinkClick:function(e){e.stopPropagation()},show:function(){this.isOpen()||s.a.prototype.show.call(this)},onBasketDataChanged:function(){this.model.set("subTotal",a.h.get("subTotal")),this.model.set("vouchersApplied",a.h.get("appliedVouchers").length>0),this.renderMiniCart()},onPriceChange:function(e,t){this.$(".j-cart-price").html(t)},renderList:function(){var e=this;new r.a({model:this.model.get("entries"),el:this.$(".mini_cart_products")}).on("delete-item",(function(){return e.model.set({deletedItems:!0,error:""})}))},renderMiniCart:function(){var e=_.extend(this.model.toJSON(),{needProductForReward:Object(l.b)()});this.setBody(this.template(e)),a.g.length||e.error||this.setTitle(""),this.renderList()},render:function(){return this.$el.append(this.baseTemplate(this.settings)),this.renderMiniCart(),this}}));t.default=d},iCQ7:function(e,t,i){"use strict";var n=i("8Qz1"),s=i("Xapy"),o=Backbone.Model.extend({defaults:{entries:n.h.get("entries"),vouchersApplied:!1,error:null,formattedPrice:"",subTotal:{},addProduct:!1,links:{cart:s.b.CART}},initialize:function(){this.on("change:subTotal",this.onChangeSubTotal,this)},onChangeSubTotal:function(e,t){var i=t.formattedValue||"";this.set("formattedPrice",i)}});t.a=o}}]);