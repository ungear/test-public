(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{"+off":function(e,s,t){"use strict";var i=Backbone.Model.extend({defaults:{title:""}});s.a=i},"6uUl":function(e,s,t){"use strict";t.r(s);t("32f0");var i=t("6hlI"),n=t("JU+T"),o=t("+off").a.extend({defaults:{title:"",newsletterTitle:TPS.messages["redesign.newsletter.subscription.popup.title"],newsletterSubTitle:TPS.messages["redesign.newsletter.subscription.popup.subtitle"],emailError:TPS.messages["redesign.newsletter.subscription.popup.email.error"],privacyError:TPS.messages["redesign.newsletter.subscription.popup.privacy.error"],privacyLabel:TPS.messages["redesign.newsletter.subscription.popup.privacy.label"],privacyBottomText:TPS.messages["redesign.newsletter.subscription.popup.privacy.bottom.text"],buttonCTA:TPS.messages["redesign.newsletter.subscription.popup.button.text"]}}),r=(t("7sEo"),n.a.extend({popUpSettings:{isTitleCentered:!1,closeOnOverlay:!1,closeOnEscape:!1,destroyOnClose:!0,showTitle:!1,classes:{popup:"j_news_subscr_popup"}},model:new o,events:{"click #j-news_subscr_form_submit":"submitEmail","input .j-email_input":"onKeyDownEvent","click .j-popup__close_btn":"closeToDate","keydown .j-news_subscr_popup__label":"simulateCheckboxChanged"},content:'\n        <div class="news_subscr_popup">\n            <h3 class="news_subscr_popup__main_title">{{=newsletterTitle}}</h3>\n            <div class="news_subscr_popup__sub-title">{{=newsletterSubTitle}}</div>\n            <form class="j-news_subscr_form"\n                  id="news-subscr-form"\n                  action="{{=TPS.utils.getInternationalUrl(\'/newsletter/signup\')}}"\n                  method="post">\n                <fieldset class="form_field news_subscr_popup__field">\n                    <div class="news_subscr_popup__error">{{=emailError}}</div>\n                    <div class="news_subscr_popup__email-wrapper">\n                        <input type="text" name="firstName" value="customer" hidden />\n                        <input class="j-email_input news_subscr_popup__input"\n                               name="emailAddress"\n                               id="news_subscr_email"\n                               placeholder="Enter your email"\n                               type="email" />\n                         <span class="form_field__icon form_field__validity_icon news_subscr_popup__validity_icon"></span>\n                    </div>\n                </fieldset>\n                <fielset class="form_field">\n                    <div class="news_subscr_popup__error news_subscr_popup__error-privacy">{{=privacyError}}</div>\n                    <div class="news_subscr_popup__privacy checkbox">\n                        <input class="form_field__checkbox"\n                               name="privacyPolicy"\n                               id="news_subscr_privacy"\n                               type="checkbox" />\n                        <label for="news_subscr_privacy" class="news_subscr_popup__label j-news_subscr_popup__label" tabindex="0">\n                            {{=privacyLabel}}\n                        </label>\n                    </div>\n                    <div class="news_subscr_popup__additional-text">{{=privacyBottomText}}</div>\n                </fielset>\n                <button id="j-news_subscr_form_submit" class="btn-black news_subscr_popup__submit">{{=buttonCTA}}</button>\n            </form>\n        </div>\n    ',onKeyDownEvent:function(e){"Enter"===e.key&&this.submitEmail(e)},validate:function(e,s){var t=!0;return""!==e.val()&&Object(i.a)(e.val())?(e.closest(".form_field").find(".news_subscr_popup__error").hide().removeClass("invalid"),this.$(".form_field__validity_icon").removeClass("form_field__validity_icon-visible")):(e.closest(".form_field").addClass("invalid").find(".news_subscr_popup__error").show(),this.$(".form_field__validity_icon").addClass("form_field__validity_icon-visible"),t=!1),s.is(":checked")?s.closest(".form_field").find(".news_subscr_popup__error").hide():(s.closest(".form_field").find(".news_subscr_popup__error").show(),t=!1),t},submitEmail:function(e){e.preventDefault();var s=$(".j-news_subscr_form"),t=TPS.utils.getInternationalUrl("/newsletter/signup"),i=s.find('input[name="firstName"]'),n=s.find("#news_subscr_email"),o=s.find("#news_subscr_privacy");if(!this.validate(n,o))return!1;var r={firstName:i.val(),emailAddress:n.val(),privacyPolicy:o.is(":checked")};this.addSpinner(),this.sendRequest(t,r).then(this.showThankYou.bind(this)).fail(this.showError.bind(this)).always(this.removeSpinner.bind(this))},sendRequest:function(e,s){return new $.Deferred((function(t){$.csrfAjax(e,s).then((function(e){"string"==typeof e?t.reject(TPS.messages["entity.error.server.default"]):e.errorCode?t.reject(e.message):e.error?t.reject(e.error):t.resolve(e)})).fail((function(e){t.reject(e)}))}))},showThankYou:function(e){this.lightBox.setContent(e),this.off("click",".j-popup__close_btn",this.closeToDate)},showError:function(e){this.lightBox.setContent(e),this.off("click",".j-popup__close_btn",this.closeToDate)},closeToDate:function(){var e=TPS.configurationManager.NEWSLETTER_POPUP_CLOSE_FOUR_X_DAYS;$.cookie("disablePopup","true",{path:"/",expires:e})},simulateCheckboxChanged:function(e){var s=e.key||e.keyCode;" "!==s&&32!==s||(e.preventDefault(),$(e.target).click())}}));s.default=r},"7sEo":function(e,s,t){},"JU+T":function(e,s,t){"use strict";t("vxnP");var i=["open","close","change:title","change:content","change:spinner"],n=Backbone.View.extend({initialize:function(e){var s=this;this.settings=$.extend({},this.popUpSettings,e.popUpSettings),this.lightBox=new TPS.Lightbox2($(_.template(this.content)(this.model.toJSON())),this.settings),i.forEach((function(e){s.listenTo(s.lightBox,e,s.trigger.bind(s,e))})),this.lightBox.setTitle(this.model.get("title")),this.setElement(this.lightBox.$popup),this.model.on("change:title",(function(e,t){return s.lightBox.setTitle(t)}))},open:function(){this.lightBox.open()},close:function(){this.settings.destroyOnClose&&this.destroy(),this.lightBox.close()},addSpinner:function(){TPS.utils.addSpinner(this.$el)},removeSpinner:function(){TPS.utils.removeSpinner(this.$el)},destroy:$.noop});s.a=n}}]);