(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{"+2J/":function(t,e,i){"use strict";i.d(e,"b",(function(){return s}));var n=i("8Qz1"),s=function(){var t=n.h.get("entries").filter((function(t){return!(t.get("product").reward||t.get("isFreeSample"))}));return TPS.user.isLoyalty&&n.h.get("entries").length>0&&0===t.length&&!n.h.get("rewardAvailable")},r=Backbone.View.extend({initialize:function(){this.model.on("change",this.render,this)},render:function(){this.$el.toggle(s())}});e.a=r},"1Y5N":function(t,e,i){"use strict";i("vxnP");var n=i("hsyc"),s=Backbone.View.extend({baseTemplate:_.template('\n        <div class="dropdown j-dropdown {{=dropdownClass}}" role="tooltip" aria-hidden="true">\n            <div class="dropdown_head">\n                <h4 class="dropdown_head__title">{{=title}}</h4>\n                <div class="dropdown_head__close j-dropdown-close"></div>\n            </div>\n            <div class="dropdown_body"></div>\n            <div class="dropdown_footer"></div>\n        </div>\n    '),events:{"click .j-dropdown-close":"close","click .dropdown":"stopPropagation","touchstart .dropdown":"stopPropagation",mouseleave:"close",mouseenter:"clearAutoClose"},defaults:{destroyOnClose:!0,show:!0,autoCloseTimeout:0,closeTimeout:0,title:"dropdown"},preinitialize:function(t){var e;this.events=_.extend(this.events,s.prototype.events),this.useHistory=null!==(e=t.useHistory)&&void 0!==e?e:window.matchMedia(TPS.config.mobileBreakpoint).matches},initialize:function(t){var e=this;return this.settings=_.extend({},this.defaults,t),this.onOutsideClick=this.onOutsideClick.bind(this),this.onHistoryPop=this.onHistoryPop.bind(this),this.close=this.close.bind(this),setTimeout(function(){n.f.on("click.dropdownOutside keydown.dropdownOutside",this.onOutsideClick)}.bind(this),0),this.template&&(this.template=_.template(this.template),this.render()),"number"==typeof this.settings.autoCloseTimeout&&this.settings.autoCloseTimeout>0&&this.setupAutoClose(this.settings.autoCloseTimeout),this.settings.show&&requestAnimationFrame((function(){return e.show()})),this},setTitle:function(t){return this.element.find(".dropdown_head__title").html(t),this},setHead:function(t){return this.element.find(".dropdown_head").html(t),this},setBody:function(t){return this.element.find(".dropdown_body").html(t),this},setFooter:function(t){return this.element.find(".dropdown_footer").html(t),this},show:function(){var t=this;return this.trigger("open"),this.element.addClass("open").attr({"aria-hidden":!1}),requestAnimationFrame((function(){return t.element.addClass("transition")})),this.calculateBoundaries(),this.useHistory&&(window.history.pushState({component:"dropdown",name:this.settings.title},null),window.addEventListener("popstate",this.onHistoryPop)),this},close:function(){var t,e=this;return this.trigger("close"),this.clearAutoClose(),this.element.removeClass("transition").attr({"aria-hidden":!0}),n.f.off(".dropdownOutside"),window.removeEventListener("popstate",this.onHistoryPop),this.useHistory&&"dropdown"===(null===(t=window.history.state)||void 0===t?void 0:t.component)&&window.history.go(-1),setTimeout((function(){e.element.removeClass("open"),e.settings.destroyOnClose&&e.destroy()}),200),this},calculateBoundaries:function(){var t=n.f.width(),e=this.element.width(),i=this.$el.width(),s=this.element.offset(),r=this.$el.offset();if(t-s.left<Math.floor(e)){var o=t-e-10,a=r.left+i/2-e/2;a+e+10<t&&(o=a),this.element.offset({left:o})}},destroy:function(){return this.trigger("destroy"),this.undelegateEvents(),this.stopListening(),this.element.remove(),this},setupAutoClose:function(){var t=this;this.settings.closeTimeout=setTimeout((function(){t.close(),clearTimeout()}),this.settings.autoCloseTimeout)},clearAutoClose:function(){clearTimeout(this.settings.closeTimeout),this.settings.closeTimeout=0},isOpen:function(){return $(this.element).hasClass("open")},onOutsideClick:function(t){if("click"===t.type){if((t.originalEvent.path||t.originalEvent.composedPath&&t.originalEvent.composedPath()||[]).indexOf(this.el)>-1)return!0;if(this.isOpen())return t.preventDefault(),this.close()}else if("keydown"===t.type&&27===t.keyCode&&this.isOpen())return t.preventDefault(),this.close();return!0},onHistoryPop:function(){var t;"dropdown"!==(null===(t=window.history.state)||void 0===t?void 0:t.component)&&this.close()},stopPropagation:function(t){t.stopPropagation()},render:function(){var t=this.model.toJSON();return this.element=$(this.baseTemplate(this.settings)),this.$el.append(this.element),this.setBody(this.template(t)),this}});e.a=s},"9TJh":function(t,e,i){},EBYT:function(t,e,i){"use strict";e.a='\n<div class="mini_cart {{=addProduct ? \'mini_cart-added\' : \'\'}}">\n    {{ if (entries.length) { }}\n        <ul class="mini_cart_products j-products_list"></ul>\n        <div class="mini_cart_total_price">\n            <div class="mini_cart_total_price__container">\n                <span class="mini_cart_total_price__text">{{=TPS.messages[\'redesign.mini.basket.total.price.text\']}}</span>\n                <span class="mini_cart_total_price__subtotal j-cart-price">{{=formattedPrice}}</span>\n            </div>\n        </div>\n        <div class="mini_cart_buttons">\n            {{ if (subTotal && subTotal.value > 0 && !needProductForReward) { }}\n                <a href="{{=links.cart}}" class="mini_cart_buttons__item mini_cart_buttons__item-checkout j-shopping_bag_link">\n                    <span class="mini_cart_buttons__text">{{=TPS.messages[\'redesign.mini.basket.checkout.button.name\']}}</span>\n                    <span class="mini_cart_buttons__icon icon icon_lock-light"></span>\n                </a>\n            {{ } else { }}\n                <button class="mini_cart_buttons__item mini_cart_buttons__item-shopping btn-black j-continue-shopping">\n                    {{=TPS.messages[\'redesign.mini.basket.continue.shopping.button.text\']}}\n                </button>\n            {{ } }}\n        </div>\n        {{ if (error) { }}\n            <div class="mini_cart__error">{{=error}}</div>\n        {{ } }}\n        {{ if (vouchersApplied) { }}\n            <div class="mini_cart__info">{{=TPS.messages[\'redesign.mini.basket.checkout.discountAdded\']}}</div>\n        {{ } }}\n    {{ } else { }}\n        {{ if (vouchersApplied) { }}\n            <div class="mini_cart__info">{{=TPS.messages[\'redesign.mini.basket.checkout.discountAdded\']}}</div>\n        {{ } }}\n        {{ if (error) { }}\n            <div class="mini_cart__error">{{=error}}</div>\n        {{ } else { }}\n            <div class="mini_cart_empty">\n                <p class="mini_cart_empty__text">\n                    {{=TPS.messages[\'redesign.mini.basket.empty.text\']}}\n                </p>\n            </div>\n            <div class="mini_cart_buttons">\n                <button class="mini_cart_buttons__item mini_cart_buttons__item-shopping btn-black j-continue-shopping">\n                    {{=TPS.messages[\'redesign.mini.basket.continue.shopping.button.text\']}}\n                </button>\n            </div>\n        {{ } }}\n    {{ } }}\n</div>\n'},Junv:function(t,e,i){"use strict";var n=i("I+eb"),s=i("6LWA"),r=[].reverse,o=[1,2];n({target:"Array",proto:!0,forced:String(o)===String(o.reverse())},{reverse:function(){return s(this)&&(this.length=this.length),r.call(this)}})},QiGF:function(t,e,i){"use strict";i("FZtP"),i("Junv"),i("vxnP");var n=i("8Qz1"),s=Backbone.View.extend({tagName:"li",template:_.template('\n        <div class="mini_cart_products_item">\n            <a class="mini_cart_products_item__link" {{ if (!product.reward) { }} href="{{=product.url}} {{ } }}">\n                <img class="mini_cart_products_item__img" src="{{=image.src}}" title="{{=image.text}}" alt="">\n            </a>\n            <div class="mini_cart_products_item_description">\n                <div class="mini_cart_products_item_description__container">\n                    <a class="mini_cart_products_item_description__brand_name" {{ if (!isFreeSample && !product.reward) { }} href="{{=product.url}}" {{ } }}>{{=product.brand}}</a>\n                    <a class="mini_cart_products_item_description__wrapper_link" {{ if (!isFreeSample && !product.reward) { }} href="{{=product.url}}" {{ } }}">\n                        <p class="mini_cart_products_item_description__range_name">{{= !isFreeSample && gwpEntry ? product.escapeName : product.range}}</p>\n\n                    {{ if (!isFreeSample) { }}\n                        {{ if (!gwpEntry) { }}\n                            <p class="mini_cart_products_item_description__type_name">\n                                {{=product.escapeName}}{{ if(product.baseOptions[0].selected.igcContentSizeUnit) { }} - {{=product.baseOptions[0].selected.igcContentSizeUnit}}{{ } }}\n                            </p>\n                        {{ } else { }}\n                            <p class="mini_cart_products_item_description__type_name">\n                                {{=product.range}}\n                            </p>\n                        {{ } }}\n                    {{ } }}\n                    </a>\n                </div>\n                <div class="mini_cart_products_item_info">\n                    <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                        <span class="mini_cart_products_item_info__amount">{{=quantity}}</span>\n                    </span>\n                    <span class="mini_cart_products_item_info__price">{{=price.base}}</span>\n                </div>\n            </div>\n            <div class="mini_cart_products_item__remove_icon j-remove_product">\n                {{ if (!gwpEntry || isFreeSample) { }}\n                    <span class="icon_cross-light"></span>\n                {{ } }}\n            </div>\n            <div class="mini_cart_products_item-removed j-after_product_remove">\n                <div class="mini_cart_products_item__wrapper">\n                    <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                </div>\n            </div>\n        </div>\n        {{ if (giftWrapProductCode) { }}\n            <div class="mini_cart_products_item j-gift">\n                <a class="mini_cart_products_item__link" href="javascript:void(0);">\n                    <img class="mini_cart_products_item__img" src="{{=giftEntry.image.src}}" title="{{=giftEntry.image.text}}" alt="">\n                </a>\n                <div class="mini_cart_products_item_description">\n                    <div class="mini_cart_products_item_description__container">\n                        <a class="mini_cart_products_item_description__range_name" href=\'javascript:void(0);\'>\n                            {{=giftEntry.product.escapeName}}\n                        </a>\n                    </div>\n                    <div class="mini_cart_products_item_info">\n                        <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                            <span class="mini_cart_products_item_info__amount">{{=quantity}}</span>\n                        </span>\n                        <span class="mini_cart_products_item_info__price">{{=giftWrapPrice.formattedValue}}</span>\n                    </div>\n                </div>\n                <div class="mini_cart_products_item__remove_icon j-remove_gift">\n                    <span class="icon_cross-light"></span>\n                </div>\n                <div class="mini_cart_products_item-removed j-after_gift_remove">\n                    <div class="mini_cart_products_item__wrapper">\n                        <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                    </div>\n                </div>\n            </div>\n        {{ } }}\n        {{ if (engravings.length) { }}\n            <div class="mini_cart_products_item j-engravings">\n                <a class="mini_cart_products_item__link" href="javascript:void(0);">\n                    <span class="mini_cart_products_item__icon icon_engraving"></span>\n                </a>\n                <div class="mini_cart_products_item_description">\n                    <div class="mini_cart_products_item_description__container">\n                        <a class="mini_cart_products_item_description__range_name" href=\'javascript:void(0);\'>\n                            {{=TPS.messages[\'redesign.mini.basket.item.engraved.message\']}}\n                        </a>\n                    </div>\n                    <div class="mini_cart_products_item_info">\n                        <span class="mini_cart_products_item_info__quantity">{{=TPS.messages[\'redesign.mini.basket.quantity.text\']}}\n                            <span class="mini_cart_products_item_info__amount">{{=engravings.length}}</span>\n                        </span>\n                        <span class="mini_cart_products_item_info__price">{{=formattedEngravingPrice}}</span>\n                    </div>\n                </div>\n                <div class="mini_cart_products_item__remove_icon j-remove_engraving">\n                    <span class="icon_cross-light"></span>\n                </div>\n                <div class="mini_cart_products_item-removed j-after_engraving_remove">\n                    <div class="mini_cart_products_item__wrapper">\n                        <span class="mini_cart_products_item__text">{{=TPS.messages[\'redesign.mini.basket.items.removed\']}}</span>\n                    </div>\n                </div>\n            </div>\n        {{ } }}\n    '),initialize:function(){this.model.on("change",this.render,this)},events:{"click .j-remove_product":"removeProduct","click .j-remove_gift":"removeGift","click .j-remove_engraving":"removeEngraving"},removeProduct:function(t){var e=this;if(t.stopPropagation(),!this.model.get("gwpEntry")||this.model.get("isFreeSample")){this.$el.addClass("spinner"),this.trigger("delete-item");var i=this.model.toJSON(),s={sku:i.product.code,quantity:i.quantity};Object(n.w)(this.model.get("entryNumber"),s).then((function(){e.$el.removeClass("spinner"),e.$(".j-after_product_remove").fadeIn(300),e.$el.fadeTo(800,0,(function(){return e.$el.slideUp(500,(function(){return e.$el.remove()}))}))}))}},removeGift:function(){var t=this,e=this.$(".j-gift");e.addClass("spinner"),Object(n.x)(this.model.get("entryNumber")).then((function(){e.removeClass("spinner"),t.$(".j-after_gift_remove").fadeIn(300),e.fadeTo(800,0,(function(){return e.slideUp(500)}))}))},removeEngraving:function(t){var e=this,i=this.$(".j-engravings");i.addClass("spinner"),Object(n.u)(this.model.get("product").code).then((function(){i.removeClass("spinner"),e.$(".j-after_engraving_remove").fadeIn(300),i.fadeTo(800,0,(function(){return i.slideUp(500)}))}))},render:function(t){if(t){if(t.changed.engravings)return;if(""===t.changed.giftWrapProductCode)return}var e=this.model.toJSON();return this.$el.html(this.template(e)),this}}),r=Backbone.View.extend({initialize:function(){this.render()},deleteItem:function(){this.trigger("delete-item")},render:function(){var t=this,e=$();return this.model.filter((function(t){return!(t.get("engraving")||t.get("giftWrap"))})).reverse().forEach((function(i){var n=new s({model:i});n.on("delete-item",t.deleteItem,t),e=e.add(n.render().$el)})),this.$el.empty(),this.$el.append(e),this}});e.a=r},iCQ7:function(t,e,i){"use strict";var n=i("8Qz1"),s=i("Xapy"),r=Backbone.Model.extend({defaults:{entries:n.h.get("entries"),vouchersApplied:!1,error:null,formattedPrice:"",subTotal:{},addProduct:!1,links:{cart:s.b.CART}},initialize:function(){this.on("change:subTotal",this.onChangeSubTotal,this)},onChangeSubTotal:function(t,e){var i=e.formattedValue||"";this.set("formattedPrice",i)}});e.a=r},we8t:function(t,e,i){"use strict";i.r(e);i("vxnP");var n=i("EBYT"),s=i("1Y5N"),r=i("iCQ7"),o=i("QiGF"),a=i("8Qz1"),d=i("Xapy"),c=i("+2J/"),l=(i("9TJh"),s.a.extend({template:n.a,model:new r.a({entries:a.g,formattedPrice:a.h.get("subTotal").formattedValue}),events:{"click .j-continue-shopping":"onContinueShoppingClick"},initialize:function(t){this.model.set({addProduct:t.added,vouchersApplied:t.vouchersApplied,error:t.error,deletedItems:!1}),s.a.prototype.initialize.call(this,_.extend(t,{dropdownClass:"header_dropdown header_dropdown_bag",title:TPS.messages[t.added?"redesign.mini.basket.items.added":"redesign.mini.basket.title.text"]})),t.added&&!t.vouchersApplied&&(this.$(".dropdown_head").prepend('<span class="mini_cart_header_added__icon icon_check"></span>'),this.$(".dropdown_head__title").removeClass("dropdown_head__title").addClass("mini_cart_header_added__text")),a.h.on("change",this.onBasketDataChanged,this),this.model.on("change:formattedPrice",this.onPriceChange,this),this.onBasketDataChanged()},show:function(){this.isOpen()||s.a.prototype.show.call(this)},onBasketDataChanged:function(){this.model.set("subTotal",a.h.get("subTotal")),this.model.set("vouchersApplied",a.h.get("appliedVouchers").length>0),this.renderMiniCart()},onPriceChange:function(t,e){this.$(".j-cart-price").html(e)},onContinueShoppingClick:function(){this.model.get("deletedItems")||window.location.pathname===d.b.HOME?this.close():(this.close(),window.location.href=d.b.HOME)},close:function(){this.model.set("error",null),s.a.prototype.close.call(this)},renderList:function(){var t=this;new o.a({model:a.g,el:this.$(".j-products_list")}).on("delete-item",(function(){return t.model.set({deletedItems:!0,error:""})}))},renderMiniCart:function(){var t=_.extend(this.model.toJSON(),{needProductForReward:Object(c.b)()});this.setBody(this.template(t)),this.$(".dropdown_head").css("display",a.g.length||t.error?"":"none"),this.renderList()},render:function(){return this.element=$(this.baseTemplate(this.settings)),this.$el.append(this.element),this.renderMiniCart(),this}}));e.default=l}}]);